# XXE (XML External Entity) Injection

## Apa itu XXE?

**XML External Entity (XXE) Injection** adalah celah keamanan yang terjadi ketika aplikasi memproses input XML tanpa konfigurasi yang aman. XXE memungkinkan penyerang untuk:

- Membaca file lokal pada server (file disclosure)
- Melakukan Server-Side Request Forgery (SSRF)
- Mengekstrak data sensitif ke server eksternal (exfiltration)
- Melakukan Denial of Service (DoS) dengan entity expansion (billion laughs attack)
- Mengakses resource internal yang seharusnya tidak dapat diakses

### Bagaimana XXE Terjadi?

XXE terjadi karena parser XML mengizinkan deklarasi entity eksternal (DTD), yang dapat dimanipulasi oleh penyerang untuk mengakses resource di luar XML itu sendiri.

Contoh sederhana entity eksternal:

```xml
<!ENTITY xxe SYSTEM "file:///etc/passwd">
```

Jika aplikasi tidak memproteksi parser XML-nya, entity di atas dapat digunakan untuk membaca file sensitif.

## Dampak XXE

- **Kebocoran data**: File sensitif seperti `/etc/passwd`, credential, atau file konfigurasi dapat diakses.
- **SSRF**: Penyerang dapat membuat server melakukan request ke internal network.
- **Remote Code Execution**: Dalam kasus tertentu, XXE dapat dieksploitasi untuk eksekusi perintah.
- **Denial of Service**: Dengan teknik entity expansion.

## Cara Mencegah XXE

- **Nonaktifkan DTD processing** pada parser XML.
- Gunakan library XML yang aman secara default (misal: defusedxml di Python).
- Validasi dan sanitasi input XML.
- Batasi akses file dan network pada server.
