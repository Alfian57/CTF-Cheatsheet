# SSTI Cheatsheet

## 1. Daftar Template Engine Populer

| Engine   | Sintaks Ekspresi | Komentar | Contoh SSTI | Bahasa Pemrograman |
| -------- | ---------------- | -------- | ----------- | ------------------ |
| Jinja2   | `{{ ... }}`      | `{# #}`  | `{{7*7}}`   | Python             |
| Mako     | `${ ... }`       | `##`     | `${7*7}`    | Python             |
| Twig     | `{{ ... }}`      | `{# #}`  | `{{7*7}}`   | PHP                |
| Smarty   | `{$ ... }`       | `{* *}`  | `{$7*7}`    | PHP                |
| Velocity | `${ ... }`       | `##`     | `${7*7}`    | Java               |
| Jade/Pug | `#{ ... }`       | `//-`    | `#{7*7}`    | JavaScript (Node)  |

## 2. Cara Mengetes SSTI

1. **Input ekspresi sederhana** ke parameter yang dicurigai, misal:

   - `{{7*7}}`
   - `${7*7}`
   - `{$7*7}`
   - `#{7*7}`

2. **Cek output**:

   - Jika hasilnya `49`, kemungkinan besar ada SSTI.

3. **Tes karakteristik engine**:

   - Coba beberapa payload berbeda untuk mengidentifikasi engine:
     - Jinja2/Twig: `{{7*7}}`
     - Smarty: `{$7*7}`
     - Mako/Velocity: `${7*7}`
     - Jade/Pug: `#{7*7}`

## 3. Menentukan Template Engine

Gunakan tabel berikut untuk mengidentifikasi engine berdasarkan respon payload:

| Payload         | Output/Respon | Engine Kemungkinan |
| --------------- | ------------- | ------------------ |
| `{{7*7}}`       | 49            | Jinja2, Twig       |
| `${7*7}`        | 49            | Mako, Velocity     |
| `{$7*7}`        | 49            | Smarty             |
| `a{*comment*}b` | ab            | Smarty             |
| `#{7*7}`        | 49            | Jade/Pug           |

Lihat diagram berikut untuk alur identifikasi engine:

![SSTI Engine Identification](./images/ssi-tree.png)

## 4. Tips & Informasi Penting

- Selalu cek output aplikasi setelah mengirim payload.
- Beberapa aplikasi melakukan filter, gunakan variasi payload.
- Setelah engine teridentifikasi, cari dokumentasi exploitasi engine tersebut.
- Gunakan payload RCE hanya pada lingkungan legal
