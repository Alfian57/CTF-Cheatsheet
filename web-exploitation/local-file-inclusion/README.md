# Local File Inclusion (LFI)

## Apa itu Local File Inclusion?

Local File Inclusion (LFI) adalah salah satu celah keamanan pada aplikasi web yang terjadi ketika aplikasi mengizinkan pengguna untuk memasukkan (include) file lokal dari server tanpa validasi yang memadai. Celah ini biasanya terjadi pada aplikasi yang menggunakan fungsi seperti `include`, `require`, atau sejenisnya di PHP, di mana nama file diambil dari input pengguna.

Jika aplikasi tidak melakukan filter atau validasi dengan benar, penyerang dapat memanfaatkan celah ini untuk membaca file sensitif pada server, melakukan enumerasi direktori, hingga eksekusi kode berbahaya (jika digabungkan dengan teknik lain seperti log poisoning).

## Contoh Skenario LFI

Misal, aplikasi memiliki kode berikut:

```php
<?php
    include($_GET['page']);
?>
```

Jika pengguna mengakses:  
`http://target.com/index.php?page=about.php`  
Maka file `about.php` akan di-include. Namun, penyerang bisa mengganti parameter menjadi:  
`http://target.com/index.php?page=../../../../etc/passwd`  
Sehingga file `/etc/passwd` akan terbaca.

## Dampak LFI

- Membaca file sensitif (misal: `/etc/passwd`, konfigurasi, credential)
- Enumerasi struktur direktori server
- Log poisoning (menyisipkan kode ke file log lalu mengeksekusinya via LFI)
- Potensi eksekusi kode remote jika digabungkan dengan teknik lain (RCE)

## Cara Mencegah LFI

- Validasi dan sanitasi input pengguna (gunakan whitelist file)
- Jangan pernah mengambil nama file langsung dari input tanpa filter
- Gunakan fungsi path yang aman (misal: realpath, basename)
- Batasi hak akses file pada server
